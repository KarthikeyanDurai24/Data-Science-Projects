# -*- coding: utf-8 -*-
"""Car Price Prediction Model

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1m3PFY5zzRlcbyByOx3mxj0EJQOSIXAUo
"""

import pandas as pd
import numpy as np

df = pd.read_csv("sample_data/car_data.csv")
df = df.apply(lambda x: x.str.strip() if x.dtype == "object" else x)

df.columns

df.info()

df.isnull().sum()

df.info()

df.head()

df.describe()

df[["name", "fuel", "seller_type", "transmission", "owner"]].describe()

df["fuel"].value_counts()

df["seller_type"].value_counts()

df["transmission"].value_counts()

df["owner"].value_counts()

x = df.iloc[:, [1,3,4,6]].values
y = df.iloc[:, 2].values

from sklearn.preprocessing import LabelEncoder
le = LabelEncoder()
x[:,2] = le.fit_transform(x[:,2])
le1 = LabelEncoder()
x[:,3] = le1.fit_transform(x[:,3])

x

from sklearn.model_selection import train_test_split as tts
x_train, x_test, y_train, y_test = tts(x, y, random_state = 0, test_size = 0.05)

from sklearn.ensemble import RandomForestRegressor

rfr_model = RandomForestRegressor(n_estimators = 300, random_state=0)
rfr_model.fit(x_train, y_train)
y_pred = rfr_model.predict(x_test)

from sklearn.metrics import r2_score, mean_squared_error
r2_score = r2_score(y_test, y_pred)
mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)
print("R2 Score:", r2_score)
print("Root mean squared error:", rmse)

new_data=[2017,46000,"Petrol","Manual"]
new_data[2]=le.transform([new_data[2]])[0]
new_data[3]=le1.transform([new_data[3]])[0]

print(new_data)
rfr_model.predict([new_data])